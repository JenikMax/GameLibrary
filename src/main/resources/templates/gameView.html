<html xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="stylesheet" type="text/css" th:href="@{/css/game.css}">
    <script>
        function openModal(img) {
            var modal = document.getElementById("modal");
            var modalImg = document.getElementById("modalImg");

            modal.style.display = "block";
            modalImg.src = img.src;
            modalImg.dataset.index = img.dataset.index;
        }

        function closeModal() {
            var modal = document.getElementById("modal");
            modal.style.display = "none";
        }

        function prevImage() {
            var modal = document.getElementById("modal");
            var modalImg = document.getElementById("modalImg");
            var currentIndex = parseInt(modalImg.dataset.index);
            var prevIndex = currentIndex - 1;

            var screenshots = document.querySelectorAll(".game_screenshots img");
            if (prevIndex >= 0 && prevIndex < screenshots.length) {
                modalImg.src = screenshots[prevIndex].src;
                modalImg.dataset.index = prevIndex;
            }
        }

        function nextImage() {
            var modal = document.getElementById("modal");
            var modalImg = document.getElementById("modalImg");
            var currentIndex = parseInt(modalImg.dataset.index);
            var nextIndex = currentIndex + 1;

            var screenshots = document.querySelectorAll(".game_screenshots img");
            if (nextIndex >= 0 && nextIndex < screenshots.length) {
                modalImg.src = screenshots[nextIndex].src;
                modalImg.dataset.index = nextIndex;
            }
        }

        // Добавляем обработчики для переключения изображений с помощью клавиатуры
        document.addEventListener("keydown", function(event) {
            var modal = document.getElementById("modal");
            if (modal.style.display === "block") {
                if (event.keyCode === 37) {
                    prevImage(); // Нажатие на клавишу влево
                } else if (event.keyCode === 39) {
                    nextImage(); // Нажатие на клавишу вправо
                } else if (event.keyCode === 27) {
                    closeModal(); // Нажатие на клавишу Esc
                }
            }
        });
    </script>
</head>
<body>
<div class="container">
    <div class="header">
        <div class="logo">
            <img src="logo.png" alt="Logo">
        </div>
        <div class="user">
            <img src="user.png" alt="User">
            <a href="profile.html">Иван Иванов</a>
            <button type="button">Выйти</button>
        </div>
    </div>
    <div class="game">
        <div class="game_info">
            <div class="title">
                <h1 th:text="${game.name} + ' (' + ${game.releaseDate} + ')'"></h1>
            </div>
            <div class="logo">
                <img th:src="${game.logo}" th:alt="${game.name}" onclick="openModal(this)">
            </div>
            <div id="modal" class="modal">
                <span class="close" onclick="closeModal()">&times;</span>
                <img id="modalImg" class="modal-content" onclick="closeModal()">
            </div>
            <div class="description">
                <span th:text="${game.platform}"></span>
                <button type="button">Скачать</button>
                <p th:text="${game.description}"></p>
            </div>
        </div>
        <div class="game_genre">
            <ul>
                <li th:each="genre : ${game.genres}" th:text="${genre.genreDescription}"></li>
            </ul>
        </div>
        <div class="game_screenshots">
            <li th:each="screenshot, stat : ${game.screenshots}">
                <img th:src="${screenshot.source}" th:alt="${screenshot.name}" onclick="openModal(this)" data-index="${stat.index}">
            </li>
        </div>
        <div class="game_trailer" th:unless="${game.trailerUrl == null or game.trailerUrl == ''}">
            <iframe th:src="${game.trailerUrl}" th:title="${game.name}"></iframe>
        </div>
        <div class="game_instruction">
            <pre th:text="${game.instruction}"></pre>
        </div>
        <div class="game_navigation">
            <a href="index.html">Назад</a>
            <a href="edit.html">Редактировать</a>
        </div>
    </div>
</div>
</body>
</html>